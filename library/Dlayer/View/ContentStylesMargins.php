<?php
/**
* Content item margin styles view helper, generates the style attributes for 
* each of the content items based on the set data
* 
* @author Dean Blackborough <dean@g3d-development.com>
* @copyright G3D Development Limited
* @version $Id: ContentStylesMargins.php 1774 2014-04-30 16:17:34Z Dean.Blackborough $
*/
class Dlayer_View_ContentStylesMargins extends Zend_View_Helper_Abstract 
{
    /**
    * Override the hinting for the view property so that we can see the view 
    * helpers that have been defined
    * 
    * @var Dlayer_View_Codehinting
    */
    public $view;
    
    /**
    * Style attributes data array for all the content item that make up the 
    * page
    * 
    * @var array
    */
    private $styles = array();
    
    /**
    * The Id for the current content item
    * 
    * @var integer
    */
    private $id;
    
    /** 
    * Content item margin values view helper, generates the style attributes 
    * for each of the content items based on the set data
    * 
    * @return Dlayer_View_ContentStylesMargins
    */
    public function contentStylesMargins() 
    {
        return $this;
    }
    
    /**
    * Reset any internal params, need to reset the params in case the view 
    * helper is called multiple times within the same view.
    * 
    * The styles data array is not reset, the array contains data for all the 
    * divs in the template, it would make no sense to clear it, needed for 
    * additional calls
    * 
    * @return void
    */
    private function resetParams() 
    {
        $this->id = NULL;
    }
    
    /**
    * Pass in the data for the current content item, at the moment all we 
    * need is the id of the content item so we can check the styles array
    * 
    * @param integer $id Id of the current div
    * @return Dlayer_View_ContentStylesMargins
    */
    public function contentItem($id) 
    {
        $this->resetParams();
        
        $this->id = $id;

        return $this;
    }
    
    /**
    * Set the content item styles data array. This array contains the 
    * additional style definitions for the entire page, rather than passing 
    * it in multiple times it only needs to be set once
    * 
    * @param array $styles
    * @return Dlayer_View_ContentStylesMargins
    */
    public function setStyles(array $styles)
    {
        $this->styles = $styles;
        
        return $this;
    }
    
    /**
    * Render method, this is the base worker method for the view helper, it 
    * generates the html.
    * 
    * @return string The generated html
    */
    private function render() 
    {       
        $html = '';
        
        if(array_key_exists($this->id, $this->styles) == TRUE) {
        	foreach($this->styles[$this->id] as $position=>$value) {
        		if($position != 'content_id') {
					$html .= ' margin-' . $position . ': ' . $value . 'px;';
        		}
        	}
        }
        
        return $html;
    }
    
    /**
    * The view helpers can be output directly, no need to call and return the 
    * render method, we define the __toString method so that echo and print 
    * calls on the object return the html generated by the render method
    * 
    * @return string The html generated by the render method
    */
    public function __toString() 
    {
        return $this->render();
    }
}